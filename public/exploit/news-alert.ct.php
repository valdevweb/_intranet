<div class="container white">
<h1>Système BBCode - lewebetlatortue.fr</h1>

		<div id="bouton_bbcode">
			<button type="button" class="bbcode_button" onclick="addBalises('#info', '[sous_titre]', '[/sous_titre]');">Titre "nouveau"</button>
			<button type="button" class="bbcode_button" onclick="addBalises('#info', '[sous_titre]', '[/sous_titre]');">Titre "info"</button>

			<!-- <button type="button" class="bbcode_button" onclick="addBalises('#info', '[p]', '[/p]');">Paragraphe</button> -->
			<!-- <button type="button" class="bbcode_button" onclick="addBalises('#info', '[br]', null);">Retour à la ligne</button> -->
			<button type="button" class="bbcode_button" onclick="addBalises('#info', '[i]', '[/i]');">Italique</button>
			<button type="button" class="bbcode_button" onclick="addBalises('#info', '<strong>', '</strong>');">Gras</button>
			<button type="button" class="bbcode_button" onclick="addBalises('#info', '[liste]', '[/liste]');">Liste</button>
			<button type="button" class="bbcode_button" onclick="addBalises('#info', '[liste_element]', '[/liste_element]');">Elément de la liste</button>
			<button type="button" class="bbcode_button" onclick="addBalises('#info', '[url=http://www.exemple.com]', 'descriptif_du_lien[/url]');">Lien</button>
			<button type="button" class="bbcode_button" onclick="addBalises('#info', '[img=url_image alt=descriptif_image]', null);">Image</button>
		</div>
		<form id="form_bbcode" name="form_bbcode" method="post" >
			<textarea id="info" name="info" rows="15" cols="100"></textarea>
			<button type="submit" name="send" class="btn btn-primary" id="send">Enregistrer les modifications</button>
		</form>



</div>



<script type="text/javascript">
	/* Ajoute les balises BBCode au contenu */
function addBalises(idTextarea, baliseOpen, baliseClose)
{
 	// Si il y a deux balises BBCode (ouvrante et fermante)
  	if (baliseClose != null) {
		// Si il n'y a aucune sélection dans le texte
 		if ($(idTextarea).prop('selectionStart') == $(idTextarea).prop('selectionEnd')) {
			var textBefore = getTextBeforeCursor($(idTextarea).val(), $(idTextarea).prop('selectionStart'));
			var textAfter = getTextAfterCursor($(idTextarea).val(), $(idTextarea).prop('selectionStart'), $(idTextarea).val().length);
			$(idTextarea).val(textBefore+baliseOpen+baliseClose+textAfter);
		// Si un du texte a été sélectionné
		} else {
			var textBefore = getTextBeforeCursor($(idTextarea).val(), $(idTextarea).prop('selectionStart'));
			var textAfter = getTextAfterCursor($(idTextarea).val(), $(idTextarea).prop('selectionEnd'), $(idTextarea).val().length);
			var textSelection = getTextSelectionCursor($(idTextarea).val(), $(idTextarea).prop('selectionStart'), $(idTextarea).prop('selectionEnd'));
			$(idTextarea).val(textBefore+baliseOpen+textSelection+baliseClose+textAfter);
		}
	// Si il n'y a qu'une balise BBCode (ouvrante ou fermante)
	} else {
		var textBefore = getTextBeforeCursor($(idTextarea).val(), $(idTextarea).prop('selectionStart'));
		var textAfter = getTextAfterCursor($(idTextarea).val(), $(idTextarea).prop('selectionStart'), $(idTextarea).val().length);
		$(idTextarea).val(textBefore+baliseOpen+textAfter);
	}
}

/* Sélection du texte présent avant la sélection du curseur */
function getTextBeforeCursor(text, value)
{
	var textBefore = '';
	for (var i = 0 ; i < value ; i++) {
		textBefore += text[i];
	}
	return textBefore;
}

/* Sélection du texte présent après la sélection du curseur */
function getTextAfterCursor(text, value, textSize)
{
	var textAfter = '';
	for (var i = value ; i < textSize ; i++) {
		textAfter += text[i];
	}
	return textAfter;
}

/* Sélection du texte présent dans la sélection du curseur */
function getTextSelectionCursor(text, startValue, endValue)
{
	var textSelection = '';
	for (var i = startValue ; i < endValue ; i++) {
		textSelection += text[i];
	}
	return textSelection;
}


</script>